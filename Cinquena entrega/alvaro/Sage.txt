p = 115792089210356248762697446949407573530086143415290314195533631308867097853951
a = -3
b = 0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b
orden = 115792089210356248762697446949407573529996955224135760342422259061068512044369
punto = (0xd8d1dd35bde259b6fb9b1f54158cdbbf4e58bd47beb810fc22e9d29e98f8492a,0x25fb9446e4429984501c5f01fd1425315c4ed964fdc50cb346d2a1bc70b4878e)
Px = punto[0]
Py = punto[1]
Gx = 0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296
Gy = 0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5
mod(Py**2,p)-mod(Px**3+a*Px+b,p)
mod(Gy**2,p)-mod(Gx**3+a*Gx+b,p)
Zp = Zmod(p)
E = EllipticCurve(Zp,[a,b])
G = E([Gx,Gy])
P = E([Px,Py])
orden*G
2*P+G

# a)
dni = '47994322'
dniConcatenado = int(dni * 8)
ClavePublica = G * dniConcatenado
ClavePublica

# b)
dni = 4799432200
aux = mod((dni**3) + (a*dni) + b, p)
aux2 = mod(aux^((p-1)/2) , p)
aux2
ClavePrivada = mod(aux^((p+1)/4), p)
ClavePrivada

# c)

k = randrange(2,orden-1)
kP = k * P
x1 = kP[0]
r = mod(x1,orden)
kinv = inverse_mod(k,orden)
s = mod(kinv * (dni + dniConcatenado * r), orden)
firma = (r,s)
firma

w = mod(s^-1, orden)
u1 = mod(dni * w, orden)
u2 = mod(r * w, orden)
aux = Integer(u1)*P + Integer(u2)*(dniConcatenado*P)
v = mod(aux[0], orden)
v

# d)
# s = k^-1 (SHA(m) + dr) mod n --> d = ((sk - dni) * r^-1) mod n
k = dni
kP = k * P
x1 = kP[0]
r = mod(x1,orden)
rinv = Integer(r).inverse_mod(orden)
claveSecreta = mod(((s*k - dni) * rinv), orden)
claveSecreta

SALIDA:

0
0
(0 : 1 : 0)
(84519194829259504267892696580131869237339685143654218758161335024723818402240 : 76219543882879995647563483202281416472515105753082788864421302187621449534992 : 1)
(11066367667441842855564828842575776747090609134873622801101648341837249820649 : 96602370973501661720325893082900267481097197212953552113209118330215599548004 : 1)
1
72041471805867407663458649257538538305428056981023124296987171886798809157442
(112907466997748256795008599422883279420406549566778416623300243644631760365948, 49083044504339136298990455002623110132998615580971565257402302217348925263737)
112907466997748256795008599422883279420406549566778416623300243644631760365948
51463684800121650059581361023648140227949981490950433829952637689651139345869